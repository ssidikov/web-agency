# Реструктуризация многоязычного сайта для SEO оптимизации (App Router)

## Обзор изменений

Был реструктурирован многоязычный сайт для улучшения SEO производительности во Франции в соответствии с лучшими практиками международного SEO, используя App Router без встроенной i18n конфигурации Next.js.

## Ключевые изменения

### 1. Удаление Next.js i18n конфигурации

**Причина**: i18n конфигурация не поддерживается в App Router Next.js 13+

**Было**:
```javascript
i18n: {
  locales: ['fr', 'en', 'ru'],
  defaultLocale: 'fr',
  localeDetection: false,
}
```

**Стало**: Ручная обработка локалей через файловую структуру и middleware

### 2. Структура URL (без редиректов)

- **Французский (по умолчанию)**: `/` - контент на французском без префикса
- **Английский**: `/en/` - файлы в папке `app/[locale]/` с locale = 'en'
- **Русский**: `/ru/` - файлы в папке `app/[locale]/` с locale = 'ru'

**Важно**: При переключении языков редиректы убраны - пользователь остается на той же странице, меняется только контент.

### 3. Переключение языков без редиректов

**LanguageSelector обновлен**:
- При выборе языка происходит только изменение контекста языка
- Пользователь остается на той же странице
- Убраны все редиректы и логика восстановления скролла
- Сохранение выбранного языка в localStorage

```typescript
const selectLanguage = (lang: 'fr' | 'en' | 'ru') => {
  if (lang === language) {
    setIsOpen(false)
    return
  }
  setIsOpen(false)
  setLanguage(lang) // Только изменение языка, без редиректов
}
```

### 4. Обновленные URL структуры

**Базовый домен**: `https://sidikoff.com` (убран www)

**Примеры URL:**
- Главная (фр): `https://sidikoff.com/`
- Главная (en): `https://sidikoff.com/en`
- Главная (ru): `https://sidikoff.com/ru`
- Услуги (фр): `https://sidikoff.com/services`
- Услуги (en): `https://sidikoff.com/en/services`
- Услуги (ru): `https://sidikoff.com/ru/services`

### 5. Hreflang теги

**Компонент**: `components/DynamicHreflang.tsx`

Автоматически генерирует hreflang теги для каждой страницы:

```html
<link rel="alternate" hreflang="fr" href="https://sidikoff.com/" />
<link rel="alternate" hreflang="en" href="https://sidikoff.com/en" />
<link rel="alternate" hreflang="ru" href="https://sidikoff.com/ru" />
<link rel="alternate" hreflang="x-default" href="https://sidikoff.com/" />
```

### 6. Canonical URL

- Французский (по умолчанию): без префикса локали
- Другие языки: с соответствующим префиксом
- x-default всегда указывает на французскую версию

### 7. Middleware обновления

**Файл**: `middleware.ts`

- Упрощен для работы с Next.js i18n
- Удалена ручная логика маршрутизации локалей
- Оставлены только специфичные для бизнеса редиректы
- Legacy project slug mappings сохранены

## SEO преимущества

### 1. Четкая языковая иерархия
- Французский как основной язык (без префикса)
- Четкое разделение альтернативных языков

### 2. Улучшенная индексация
- Поисковые системы четко понимают структуру
- x-default указывает на основной французский контент
- Canonical URL исключают дублирование контента

### 3. Местная оптимизация
- Французский контент приоритизирован для французского рынка
- Убрано автоматическое определение языка
- Стабильная структура URL для поисковых роботов

### 4. Международная доступность
- Английский и русский языки остаются доступными
- Правильные hreflang теги для международной SEO
- Переключение языков сохранено для пользователей

## Техническая реализация

### Компоненты

1. **DynamicHreflang** - динамическая генерация hreflang тегов
2. **LanguageSelector** - обновлен для работы с новой структурой
3. **LanguageContext** - убрано автоматическое определение языка

### Файлы конфигурации

1. **next.config.mjs** - добавлена i18n конфигурация
2. **middleware.ts** - упрощен для работы с Next.js i18n
3. **lib/seo.ts** - обновлены все URL на новый домен

### Структура приложения

```
app/
├── page.tsx              # Французская версия (/)
├── [locale]/
│   ├── page.tsx         # Английская и русская (/en, /ru)
│   └── ...
└── ...
```

## Миграция и совместимость

### Редиректы
- Legacy project slugs автоматически перенаправляются
- Старые URL с /fr/ автоматически обрабатываются Next.js i18n

### Обратная совместимость
- Все существующие функции сохранены
- Переключение языков работает как раньше
- Поддержка всех устройств и браузеров

## Мониторинг и валидация

### Инструменты проверки
- Google Search Console для мониторинга индексации
- Screaming Frog для проверки hreflang тегов
- GTMetrix/PageSpeed для производительности

### Ключевые метрики
- Позиции в поиске для французского рынка
- CTR по языковым версиям
- Core Web Vitals по локалям

---

**Статус**: ✅ Реализовано  
**Дата**: Июль 2025  
**Версия**: v2.0 - SEO Optimized Multilingual Structure
